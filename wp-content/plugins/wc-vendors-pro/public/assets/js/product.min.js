jQuery(function(t){function e(){var e=t("#product-type").val(),a=t("#_virtual").is(":checkbox")?t("input#_virtual:checked").size():t("#_virtual").val(),i=t("#_downloadable").is(":checkbox")?t("input#_downloadable:checked").size():t("#_downloadable").val(),o=".hide_if_downloadable, .hide_if_virtual",n=".show_if_downloadable, .show_if_virtual, .show_if_external";t.each(wcv_frontend_product.product_types,function(t,e){o=o+", .hide_if_"+e,n=n+", .show_if_"+e}),t(o).show(),t(n).hide(),i&&t(".show_if_downloadable").show(),a&&t(".show_if_virtual").show(),t(".show_if_"+e).show(),i&&t(".hide_if_downloadable").hide(),a&&t(".hide_if_virtual").hide(),"grouped"==e&&Ink.requireModules(["Ink.Dom.Selector_1","Ink.UI.Tabs_1"],function(t,e){var a=new e("#wcv-tabs");a.changeTab("#linked_product")}),t(".hide_if_"+e).hide(),t("input#_manage_stock").change()}function a(){var e,a,i=t(".wcv-featuredimg").data("title"),o=t(".wcv-featuredimg").data("button_text");return void 0!==e?void e.open():(e=wp.media({title:i,button:{text:o},multiple:!1}),e.on("select",function(){a=e.state().get("selection").first().toJSON(),0>t.trim(a.url.length)||(attachment_image_url=a.sizes.thumbnail?a.sizes.thumbnail.url:a.url,t(".wcv-featuredimg").append('<img src="'+attachment_image_url+'" alt="'+a.caption+'" title="'+a.title+'" style="max-width: 100%;" />'),t("#_featured_image_id").val(a.id),t(".wcv-media-uploader-featured-add").addClass("hidden"),t(".wcv-media-uploader-featured-delete").removeClass("hidden"))}),void e.open())}function i(){var e,a=t("#product_image_gallery"),i=t("#product_images_container ul.product_images"),n=a.val(),r=t(".wcv-media-uploader-gallery a");if(void 0!==e)return void e.open();if(e=wp.media.frames.product_gallery=wp.media({title:r.data("choose"),button:{text:r.data("update")},states:[new wp.media.controller.Library({title:r.data("choose"),filterable:"all"})]}),e.on("select",function(){var t=e.state().get("selection");t.map(function(t){t=t.toJSON(),t.id&&(n=n?n+","+t.id:t.id,attachment_image=t.sizes.thumbnail?t.sizes.thumbnail.url:t.url,i.append('\t\t\t\t\t\t<li class="wcv-gallery-image" data-attachment_id="'+t.id+'">\t\t\t\t\t\t\t<img src="'+attachment_image+'" />\t\t\t\t\t\t\t<ul class="actions">\t\t\t\t\t\t\t\t<li><a href="#" class="delete" title="'+r.data("delete")+'"><i class="fa fa-times"></i></a></li>\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t</li>'))}),a.val(n)}),o()){var l=t("#product_images_container").data("gallery_max_notice");alert(l)}else e.open()}function o(){var e=t(".wcv-gallery-image").length,a=t("#product_images_container").data("gallery_max_upload")-1;return e>a}function n(e,a){t(e).is(":checked")?(a.prop("disabled",!0),a.each(function(){t(this).is(":checkbox")?t(this).removeAttr("checked"):t(this).val("")})):a.prop("disabled",!1)}var r=!1;t("select#product-type").change(function(){var a=t(this).val();"variable"===a?(t("input#_manage_stock").change(),t("input#_downloadable").prop("checked",!1),t("input#_virtual").removeAttr("checked")):"grouped"===a?(t("input#_downloadable").prop("checked",!1),t("input#_virtual").removeAttr("checked")):"external"===a&&(t("input#_downloadable").prop("checked",!1),t("input#_virtual").removeAttr("checked")),e(),t("ul.wc-tabs li:visible").eq(0).find("a").click(),t("body").trigger("woocommerce-product-type-change",a,t(this))}).change(),t("input#_downloadable, input#_virtual").change(function(){e()}),t(".sale_price_dates_fields").each(function(){var e=!1;t(".sale_price_dates_fields").find("input").each(function(){""!=t(this).val()&&(e=!0)}),e?(t(".sale_schedule").hide(),t(".sale_price_dates_fields").show()):(t(".sale_schedule").show(),t(".sale_price_dates_fields").hide())}),t(".sale_schedule").on("click",function(){return t(".sale_price_dates_fields").show(),t(this).hide(),t(".cancel_sale_schedule").show(),!1}),t(".cancel_sale_schedule").on("click",function(){return t(".sale_price_dates_fields").hide(),t(this).hide(),t(".sale_schedule").show(),!1}),t("input#_manage_stock").change(function(){t(this).is(":checked")?t("div.stock_fields").show():t("div.stock_fields").hide()}).change(),t(".wcv-media-uploader-featured-delete").on("click",function(e){e.preventDefault(),t(".wcv-featuredimg").html(""),t(".wcv-media-uploader-featured-delete").addClass("hidden"),t(".wcv-media-uploader-featured-add").removeClass("hidden")}),t(".wcv-media-uploader-featured-add").on("click",function(t){return t.preventDefault(),a(),!1}),t("#product_images_container").on("click","a.delete",function(e){var a=t("#product_image_gallery");e.preventDefault(),t(this).closest("li.wcv-gallery-image").remove();var i="";return t("#product_images_container ul li.wcv-gallery-image").css("cursor","default").each(function(){var t=jQuery(this).attr("data-attachment_id");i=i+t+","}),a.val(i),t("#tiptip_holder").removeAttr("style"),t("#tiptip_arrow").removeAttr("style"),!1}),t(".wcv-media-uploader-gallery").on("click",function(t){return t.preventDefault(),i(),!1}),t("#files_download").on("click",".downloadable_files a.insert",function(){return t(this).closest(".downloadable_files").find("tbody").append(t(this).data("row")),!1}),t("#files_download").on("click",".downloadable_files a.delete",function(){return t(this).closest("tr").remove(),!1});var l,c;t(document).on("click",".upload_file_button",function(e){var a=t(this);if(c=a.closest("tr").find(".file_url"),file_id_field=a.closest("tr").find(".file_id"),file_display_field=a.closest("tr").find(".file_display"),e.preventDefault(),l)return void l.open();var i=[new wp.media.controller.Library({library:wp.media.query(),multiple:!0,title:a.data("choose"),priority:20,filterable:"uploaded"})];l=wp.media.frames.downloadable_file=wp.media({title:a.data("choose"),library:{type:""},button:{text:a.data("update")},multiple:!0,states:i}),l.on("select",function(){var t="",e="",a=0,i=l.state().get("selection");i.map(function(i){e="file_url"==wcv_frontend_product.wcv_file_display?i.attributes.url:i.attributes.filename,i=i.toJSON(),i.url&&(t=i.url),i.id&&(a=i.id)}),c.val(t),file_display_field.val(e),file_id_field.val(a)}),l.on("ready",function(){l.uploader.options.uploader.params={type:"downloadable_product"}}),l.open()}),t(".downloadable_files tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65}),t("#_shipping_fee_national_disable").change(function(){n(t(this),t(".wcv-disable-national-input"))}),t("#_shipping_fee_national_free").change(function(){n(t(this),t("#_shipping_fee_national"))}),t("#_shipping_fee_international_disable").change(function(){n(t(this),t(".wcv-disable-international-input"))}),t("#_shipping_fee_international_free").change(function(){n(t(this),t("#_shipping_fee_international"))}),t("#shipping").on("click",".wcv_shipping_rates a.insert",function(){return t(this).closest(".wcv_shipping_rates").find("tbody").append(t(this).data("row")),!1}),t("#shipping").on("click",".wcv_shipping_rates a.delete",function(){return t(this).closest("tr").remove(),!1}),t(".wcv_shipping_rates tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65}),t(".select2").select2(),e(),n(t("#_shipping_fee_national_free"),t("#_shipping_fee_national")),n(t("#_shipping_fee_international_free"),t("#_shipping_fee_international")),n(t("#_shipping_fee_national_disable"),t(".wcv-disable-national-input")),n(t("#_shipping_fee_international_disable"),t(".wcv-disable-international-input")),t(".confirm_delete").on("click",function(e){confirm(t(this).data("confirm_text"))||e.preventDefault()});var d=t(".product_attributes").find(".woocommerce_attribute").get();d.sort(function(e,a){var i=parseInt(t(e).attr("rel"),10),o=parseInt(t(a).attr("rel"),10);return i<o?-1:i>o?1:0}),t(d).each(function(e,a){t(".product_attributes").append(a)}),t(".product_attributes .woocommerce_attribute").each(function(e,a){"none"!==t(a).css("display")&&t(a).is(".taxonomy")&&t("select.attribute_taxonomy").find('option[value="'+t(a).data("taxonomy")+'"]').attr("disabled","disabled")}),t(".wcv_product_attributes").on("click",".wcv-metabox h5",function(e){t(e.target).filter(":input, option, .sort").length||t(this).next(".wcv-metabox-content").stop().slideToggle()}).on("click",".expand_all",function(){return t(this).closest(".wcv_product_attributes").find(".wcv-metabox > .wcv-metabox-content").show(),!1}).on("click",".close_all",function(){return t(this).closest(".wcv_product_attributes").find(".wcv-metabox > .wcv-metabox-content").hide(),!1}),t(".wcv-metabox.closed").each(function(){t(this).find(".wcv-metabox-content").hide()}),t(function(e){function a(e,a,i,o){var n=t("#wcv-variation-attributes").data("variation_attr");jQuery.isEmptyObject(n)&&(n={});var l={};return l.values=e,l.position=i,l.name=a,l.label=o,n[a]=l,t("#wcv-variation-attributes").data("variation_attr",n),r&&console.log(t("#wcv-variation-attributes").data("variation_attr")),!1}function i(e){var a=t("#wcv-variation-attributes").data("variation_attr");return jQuery.isEmptyObject(a)||(delete a[e],t("#wcv-variation-attributes").data("variation_attr",a),r&&console.log(t("#wcv-variation-attributes").data("variation_attr"))),!1}function o(e,o,n){var r={},l=e.parent().data("taxonomy"),c=e.parent().data("index_value");if(t("#attribute_variation_"+c).is(":checked"))if(e.is("input")){var d=e.val().split(wcv_frontend_product.wc_deliminator);t.each(d,function(e,a){t.trim(a).length>0&&(r[t.trim(a).toLowerCase()]=t.trim(a))})}else{var d=e.select2("data");t.each(d,function(t,e){r[e.id]=e.text})}jQuery.isEmptyObject(r)?i(l):a(r,l,o,n)}function n(){t(".attribute_values").each(function(){var e=t(this).parent().data("index_value"),a=t("#attribute_position_"+e).val(),i=t(this).closest(".woocommerce_attribute").data("label");o(t(this),a,i)})}function l(){t(".product_attributes .woocommerce_attribute").each(function(e,a){t(".attribute_position",a).val(parseInt(t(a).index(".product_attributes .woocommerce_attribute"),10));var i=t(this).data("index_value"),a=t("#attribute_values_"+i),n=t("#attribute_position_"+i).val(),r=t(this).data("label");o(a,n,r)})}t("button.add_attribute").on("click",function(){var e=t(".product_attributes .woocommerce_attribute").size(),a=t("select.attribute_taxonomy").val();if(a){var i=t(".product_attributes "),o=t("#product-type").val(),n={action:"wcv_json_add_attribute",taxonomy:a,i:e,security:wcv_frontend_product.wcv_add_attribute_nonce};return t.post(wcv_frontend_product.ajax_url,n,function(e){e.error?window.alert(e.error):(i.append(e),t("select.attribute_values.select2").select2("destroy").select2(),"variable"!==o&&i.find(".enable_variation").hide(),t(document.body).trigger("wc-enhanced-select-init"),l(),t(document.body).trigger("woocommerce_added_attribute"))}),a&&(t("select.attribute_taxonomy").find('option[value="'+a+'"]').attr("disabled","disabled"),t("select.attribute_taxonomy").val("")),!1}}),t(".product_attributes").on("click","button.select_all_attributes",function(){var e=t(this).parent().data("index_value");return t("#attribute_values_"+e+" > option").prop("selected","selected"),t("#attribute_values_"+e).trigger("change"),!1}),t(".product_attributes").on("click","button.select_no_attributes",function(){var e=t(this).parent().data("index_value"),a=t(this).parent().data("taxonomy");return t("#attribute_values_"+e+" > option").removeAttr("selected"),t("#attribute_values_"+e).trigger("change"),t("#attribute_variation_"+e).is(":checked")&&i(a),!1}),t(".product_attributes").on("change",".attribute_values",function(){var e=t(this).parent().data("index_value"),a=t("#attribute_position_"+e).val(),i=t(this).closest(".woocommerce_attribute").data("label");o(t(this),a,i)}),t(".product_attributes").on("change",".wcv_variation_checkbox",function(){var e=t(this).parent().parent().parent().data("index_value"),a=t(this).closest(".woocommerce_attribute").data("taxonomy"),n=t(this).closest(".woocommerce_attribute").data("label"),r=t("#attribute_position_"+e).val(),l=t("#attribute_values_"+e);t(this).is(":checked")?o(l,r,n):i(a)}),t(".product_attributes").on("click",".remove_row",function(){if(window.confirm(wcv_frontend_product.remove_attribute)){var e=t(this).parent().parent();e.is(".taxonomy")?(e.find("select, input[type=text]").val(""),e.hide(),t(".attribute_taxonomy").find('option[value="'+e.data("taxonomy")+'"]').removeAttr("disabled")):(e.find("select, input[type=text]").val(""),e.hide(),l()),i(e.data("taxonomy"))}return!1}),t(".product_attributes").sortable({items:".woocommerce_attribute",cursor:"move",axis:"y",handle:"h5",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wcv-metabox-sortable-placeholder",start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){var a=e.item.data("index_value");e.item.removeAttr("style"),l(a)}}),l(),n()}),t(".product_attributes").on("click","button.add_new_attribute",function(){t(".product_attributes").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e=t(this).parent().data("index_value"),a=t("#attribute_values_"+e),i=t(this).parent().data("taxonomy"),o=window.prompt(wcv_frontend_product.new_attribute_prompt);if(o){var n={action:"wcv_json_add_new_attribute",taxonomy:i,term:o,security:wcv_frontend_product.wcv_add_attribute_nonce};t.post(wcv_frontend_product.ajax_url,n,function(e){e.error?window.alert(e.error):e.slug&&(a.append(t("<option />").attr("value",e.slug).prop("selected","selected").text(e.name)),a.trigger("change"),t(a).select2("destroy").select2()),t(".product_attributes").unblock()})}else t(".product_attributes").unblock();return!1})});